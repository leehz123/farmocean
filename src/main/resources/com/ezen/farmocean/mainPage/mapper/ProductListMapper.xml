<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ezen.farmocean.mainPage.mapper.ProductListMapper">

	<select id="getProcNewList" resultType="com.ezen.farmocean.mainPage.dto.Product">
		<![CDATA[
			select * from (				
    		select * 
    		from prod_detail where prod_sell = '판매중' 
    		order by prod_idx desc )
    		WHERE ROWNUM <= 10
    	]]>
	</select>
	
	<select id="getMemberIdByNickname" resultType="string">
		SELECT member_id FROM members WHERE member_nickname = #{member_nickname}
	</select>
	
<!-- 
	<select id="getProcNewList" resultType="com.ezen.farmocean.mainPage.dto.Product">
		select pd.prod_idx, pd.prod_name, pd.prod_price , pd.prod_sell_deadline, m.member_id, m.member_nickname
            from prod_detail pd, members m
            where pd.member_id = m.member_id
            order by prod_idx desc
	</select>
	 -->
	
	<select id="getProcPopList" resultType="com.ezen.farmocean.mainPage.dto.Product">				
    	<![CDATA[
			select * from (				
    		select * 
    		from prod_detail where prod_sell = '판매중' 
    		order by prod_idx asc )
    		WHERE ROWNUM <= 10
    	]]>
	</select>
	
	<select id="getProcCateList" resultType="com.ezen.farmocean.mainPage.dto.Product">				
    	<![CDATA[
			select * from (				
    		select * 
    		from prod_detail where prod_sell = '판매중' and cate_idx = ${cate_idx}
    		order by prod_idx desc )
    		WHERE ROWNUM <= 10
    	]]>
	</select>
	
	<!-- 카테고리 별 목록 -->
	<!-- 과일류  -->
	<select id="getProcCateAllList1" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx IN (1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14)   	
		]]>
	</select>
	<!-- 식량작물 -->
	<select id="getProcCateAllList2" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx IN (15, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48)
    	]]>
	</select>
	<!-- 뿌리 -->
	<select id="getProcCateAllList3" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx IN (47, 49, 50, 51, 52)
    	]]>
	</select>
	<!-- 건강 -->
	<select id="getProcCateAllList4" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx > 52 AND cate_idx < 57
    	]]>
	</select>
	<!-- 생선 -->
	<select id="getProcCateAllList5" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx > 56 AND cate_idx < 73
    	]]>
	</select>
	<!-- 채소 -->
	<select id="getProcCateAllList6" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx > 15 AND cate_idx < 30
    	]]>
	</select>
	<!-- 특용작물 -->
	<select id="getProcCateAllList7" resultType="com.ezen.farmocean.mainPage.dto.Cate">				
		<![CDATA[
			select * from cate where cate_idx > 29 AND cate_idx < 37 	
		]]>
	</select>
	
	
	<select id="getProcBidsList" resultType="com.ezen.farmocean.mainPage.dto.Product">				
    	<![CDATA[
			select * from (				
    		select * 
    		from prod_detail where prod_sell = '판매중'
    		order by PROD_HEARTNUM desc, PROD_IDX DESC )
    		WHERE ROWNUM <= 8
    	]]>
	</select>
	
	<!-- 검색 -->
	<select id="selMemberIdInfo" resultType="com.ezen.farmocean.member.dto.Member">
		select MEMBER_ID , substr(MEMBER_PW,0,0) || '******' as MEMBER_PW, MEMBER_NAME, MEMBER_NICKNAME,MEMBER_POINT,
				MEMBER_EMAIL,MEMBER_PHONENUM,MEMBER_ACCOUNTNUM,MEMBER_ADDRESS,MEMBER_ACCOUNT_STATUS,MEMBER_TYPE, 
				MEMBER_IMAGE,MEMBER_REPORT  
		from members where MEMBER_ID = '${member_id}'			
	</select>
	
	<select id="selMemberNickInfo" resultType="com.ezen.farmocean.member.dto.Member">
		select MEMBER_ID , substr(MEMBER_PW,0,0) || '******' as MEMBER_PW, MEMBER_NAME, MEMBER_NICKNAME,MEMBER_POINT,
				MEMBER_EMAIL,MEMBER_PHONENUM,MEMBER_ACCOUNTNUM,MEMBER_ADDRESS,MEMBER_ACCOUNT_STATUS,MEMBER_TYPE, 
				MEMBER_IMAGE,MEMBER_REPORT 
		 from members where MEMBER_NICKNAME = '${member_nickName}'			
	</select>
	
	<select id="selProdIdInfo" resultType="com.ezen.farmocean.prod.dto.Product">
		select PROD_IDX,substr(PROD_NAME, 1, 15) || '..' as PROD_NAME,substr(PROD_INFO, 1, 0) || '생략' as PROD_INFO,
				PROD_SELL,PROD_SELL_DEADLINE,MEMBER_ID,PROD_STOCK,
				CATE_IDX,PROD_DELETE,PROD_PRICE,PROD_HEARTNUM 
		from prod_detail where MEMBER_ID = '${member_id}' order by prod_idx desc
	</select>
	
	<select id="selProdNumInfo" resultType="com.ezen.farmocean.prod.dto.Product">
		select PROD_IDX,substr(PROD_NAME, 1, 15) || '..' as PROD_NAME,substr(PROD_INFO, 1, 0) || '생략' as PROD_INFO,
				PROD_SELL,PROD_SELL_DEADLINE,MEMBER_ID,PROD_STOCK,
				CATE_IDX,PROD_DELETE,PROD_PRICE,PROD_HEARTNUM 
		from prod_detail where PROD_IDX = ${prod_idx} order by prod_idx desc
	</select>
	
	<select id="selProdNameInfo" resultType="com.ezen.farmocean.prod.dto.Product">
		select PROD_IDX,substr(PROD_NAME, 1, 15) || '..' as PROD_NAME,substr(PROD_INFO, 1, 0) || '생략' as PROD_INFO,
				PROD_SELL,PROD_SELL_DEADLINE,MEMBER_ID,PROD_STOCK,
				CATE_IDX,PROD_DELETE,PROD_PRICE,PROD_HEARTNUM 
		from prod_detail where PROD_NAME LIKE '%${prod_name}%' order by prod_idx desc
	</select>
	
	<select id="selCateTopList" resultType="Integer">
		select cate_main from cate where cate_main is not null and cate_use = 1
		group by cate_main order by cate_main
	</select>
	
	<select id="selCateSubList" resultType="com.ezen.farmocean.prod.dto.Cate">
		select * from cate where cate_main = ${cate_main} and  cate_use = 1 
	</select>
	
</mapper>